[gd_scene load_steps=15 format=3 uid="uid://c8lphal32dpu2"]

[ext_resource type="Script" uid="uid://bv2iyviv6c85t" path="res://Shader/LensManager.gd" id="1_63qhi"]
[ext_resource type="PackedScene" uid="uid://prju72f4cqpl" path="res://Levels/main_level/main_normal.tscn" id="2_dsr8i"]
[ext_resource type="PackedScene" uid="uid://ypx86nl676vu" path="res://Levels/main_level/main_echo.tscn" id="3_d1nr7"]
[ext_resource type="PackedScene" uid="uid://ehmpjgdaqruo" path="res://Levels/main_level/main_visceral.tscn" id="4_pltfe"]
[ext_resource type="PackedScene" uid="uid://8mrvpxdhwgw2" path="res://Levels/main_level/main_truth.tscn" id="5_7uxuk"]
[ext_resource type="PackedScene" uid="uid://b1kbx13hxs2bs" path="res://UI/pause.tscn" id="6_dsr8i"]
[ext_resource type="PackedScene" uid="uid://bxahjwaaqcpny" path="res://Player/Player.tscn" id="6_kpj74"]
[ext_resource type="Shader" uid="uid://dsi1c6aevivx2" path="res://Shader/viniet.gdshader" id="7_d1nr7"]
[ext_resource type="Script" uid="uid://dhcekjbfkfyp0" path="res://Shader/VinietController.gd" id="8_pltfe"]

[sub_resource type="ViewportTexture" id="ViewportTexture_f87w0"]
viewport_path = NodePath("CanvasLayer/Texture_Normal/Viewport_Normal")

[sub_resource type="ViewportTexture" id="ViewportTexture_afen0"]
viewport_path = NodePath("CanvasLayer/Texture_Echo/Viewport_Echo")

[sub_resource type="ViewportTexture" id="ViewportTexture_w4v7x"]
viewport_path = NodePath("CanvasLayer/Texture_Visceral/Viewport_Visceral")

[sub_resource type="ViewportTexture" id="ViewportTexture_mkyii"]
viewport_path = NodePath("CanvasLayer/Texture_Truth/Viewport_Truth")

[sub_resource type="ShaderMaterial" id="ShaderMaterial_pltfe"]
shader = ExtResource("7_d1nr7")
shader_parameter/intensity = 0.5
shader_parameter/size = 0.8
shader_parameter/vignette_color = Color(0, 0, 0, 1)

[node name="Root" type="Node2D"]

[node name="CanvasLayer" type="CanvasLayer" parent="."]
script = ExtResource("1_63qhi")

[node name="Texture_Normal" type="TextureRect" parent="CanvasLayer"]
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
texture = SubResource("ViewportTexture_f87w0")

[node name="Viewport_Normal" type="SubViewport" parent="CanvasLayer/Texture_Normal"]
size = Vector2i(1920, 1080)
render_target_update_mode = 0

[node name="TestNormal" parent="CanvasLayer/Texture_Normal/Viewport_Normal" instance=ExtResource("2_dsr8i")]

[node name="Texture_Echo" type="TextureRect" parent="CanvasLayer"]
z_index = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
texture = SubResource("ViewportTexture_afen0")

[node name="Viewport_Echo" type="SubViewport" parent="CanvasLayer/Texture_Echo"]
size = Vector2i(1920, 1080)
render_target_update_mode = 0

[node name="TestEcho" parent="CanvasLayer/Texture_Echo/Viewport_Echo" instance=ExtResource("3_d1nr7")]

[node name="Texture_Visceral" type="TextureRect" parent="CanvasLayer"]
z_index = 2
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
texture = SubResource("ViewportTexture_w4v7x")

[node name="Viewport_Visceral" type="SubViewport" parent="CanvasLayer/Texture_Visceral"]
size = Vector2i(1920, 1080)
render_target_update_mode = 0

[node name="TestVisceral" parent="CanvasLayer/Texture_Visceral/Viewport_Visceral" instance=ExtResource("4_pltfe")]

[node name="Texture_Truth" type="TextureRect" parent="CanvasLayer"]
visible = false
z_index = 3
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
texture = SubResource("ViewportTexture_mkyii")

[node name="Viewport_Truth" type="SubViewport" parent="CanvasLayer/Texture_Truth"]
size = Vector2i(1920, 1080)
render_target_update_mode = 0

[node name="TestTruth" parent="CanvasLayer/Texture_Truth/Viewport_Truth" instance=ExtResource("5_7uxuk")]

[node name="Pause" parent="CanvasLayer" instance=ExtResource("6_dsr8i")]
z_index = 1000

[node name="ColorRect" type="ColorRect" parent="CanvasLayer" groups=["V"]]
z_index = 200
material = SubResource("ShaderMaterial_pltfe")
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
color = Color(1, 1, 1, 0)
script = ExtResource("8_pltfe")

[node name="Player" parent="." groups=["Player"] instance=ExtResource("6_kpj74")]
position = Vector2(-1321, -119)
